# Распознавание объектов железнодорожной инфраструктуры

Проект посвящён обучению модели **YOLOv11-seg** для распознавания и сегментации объектов на фотографиях железнодорожной инфраструктуры.

## Описание проекта

Цель — разработать модель, способную автоматически выделять на изображениях следующие объекты:
- поезда;
- колёсные пары;
- рельсы и шпалы;
- столбы и линии электропередач;
- людей и элементы инфраструктуры.

Разметка изображений выполнена в сервисе **RoboFlow**.  
Обучение проводилось на модели YOLOv11-seg с использованием аугментаций (вращения, сдвиги, масштабирование, зеркалирование, Cutout).

---

## Структура проекта

```
├── data/                   # Датасет (train / valid / test)
│   ├── train/
│   ├── valid/
│   └── test/
│
├── train.py                # Скрипт обучения модели YOLOv11-seg
├── validate.py             # Скрипт валидации обученной модели
├── inference.py            # Веб-интерфейс (Gradio) для тестирования модели
├── data.yaml               # Конфигурация классов и путей к данным
├── yolo11l-seg.pt          # Базовые веса модели
└── runs/segment/train/     # Результаты обучения (графики, предсказания)
```

---

## Обучение модели

- Обучение выполнялось 100 эпох  
- Размер изображений: 640×640  
- Аугментации: вращения, сдвиги, масштабирование, зеркалирование, Cutout  
- Среда: Python 3.12, Torch 2.9 (CPU), Ultralytics YOLO 8.3  

Результаты обучения и валидации автоматически сохраняются в папку `runs/segment/train/`

---

## Метрики

Результаты валидации:

| Метрика | Значение |
|----------|-----------|
| Box mAP@[0.5:0.95] | 0.26 |
| Mask mAP@[0.5:0.95] | 0.15 |
| Box mAP@0.5 | 0.41 |
| Mask mAP@0.5 | 0.34 |

Модель уверенно определяет крупные объекты (поезда, рельсы, колёсные пары),  
однако сложнее справляется с мелкими или частично закрытыми объектами.

---

## Примеры работы модели

Примеры изображений с результатами сегментации находятся в:

```
runs/segment/train/
runs/segment/val2/
```

Файлы:
- `val_batchN_pred.jpg` — примеры предсказаний  
- `results.png` — графики обучения  
- `confusion_matrix_normalized.png` — распределение ошибок по классам

---

## Веб-интерфейс (inference.py)

Файл `inference.py` реализует веб-приложение на базе **Gradio**.  
Приложение позволяет загрузить изображение и получить результат сегментации модели в реальном времени.

Пример запуска:
```bash
python inference.py
```

После запуска откроется локальный веб-интерфейс по адресу:
```
http://127.0.0.1:7860
```

---

## Используемые технологии

- Python 3.12  
- Ultralytics YOLOv11  
- PyTorch  
- OpenCV  
- Gradio  

---

## Авторы проекта

- Булгаков Вячеслав  
- Ильин Антон  
- Кочетков Максим  
- Михайлов Андрей  
- Сагинадзе Ника  
